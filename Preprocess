import nltk
import numpy as np
import pandas as pd
from string import digits
import os
class preprocess():
    def imp(self,dic):                                #引入数据
        global init
        init = pd.DataFrame()                         
        for filename in os.listdir(dic):              #listdir的参数是文件夹的路径
            filenames = open(dic+filename)    
            context = pd.DataFrame(filenames)
            if context.empty!=True:
                drug = filename.split('.')[0]
                context = context[0].str.split('\t',expand=True)
                context[1] = context[1].str.split(' ',expand=True)
                context[2] = context[2].str.split('\n',expand = True)
                context[0] = drug                     #提取药名
                init = pd.concat([init,context],axis=0)
        return init
    def statistic(self):                               #统计信息
        global init
        fre = init[1].value_counts()
        print(fre)                                     #打印各tag出现次数
        for i in (fre.index.values):
            length = 0
            select = init[init[1].isin([i])][2]
            for g in range(len(select)):
                length+=len(select.iloc[g])
            print("Averge Length of "+i+" is "+str(length/len(select)))    #打印tag对应文本平均长度
        
        
